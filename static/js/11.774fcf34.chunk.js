(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{271:function(e,t,n){"use strict";var a=n(18),r=n(19),i=n(22),c=n(20),o=n(21),l=n(0),s=n.n(l),u=n(26),m=(n(272),function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={curVal:e.curVal},n}return Object(o.a)(t,e),Object(r.a)(t,[{key:"handleChange",value:function(e){e.target.value!==this.state.curVal&&(this.setState({curVal:e.target.value}),this.props.onChange&&this.props.onChange(e.target.value))}},{key:"render",value:function(){var e=this,t=this;return s.a.createElement("div",{className:"ctl-radio-list"},this.props.data.map(function(n){return s.a.createElement("label",{className:"label mr8",key:n.value},s.a.createElement("input",{className:"input",type:"radio",name:t.props.name,value:n.value,disabled:t.props.disabled,checked:e.state.curVal+""===n.value+"","data-log":typeof e.state.curVal+"|"+typeof n.value,onChange:function(e){return t.handleChange(e)}}),n.label)}))}}]),t}(l.Component));t.a=Object(u.c)(function(){return{}},{})(m)},272:function(e,t,n){},336:function(e,t,n){},338:function(e,t,n){"use strict";var a=n(18),r=n(19),i=n(22),c=n(20),o=n(21),l=n(17),s=n(61),u=n(0),m=n.n(u),d=n(58),p=n(37),f=n(23),h=n(6),b=n.n(h),v=n(119),g=n(3),O=n(26),E=n(271),j={RADIO_LIST_DATA_VISIBILITY:[{label:"\u79c1\u6709",value:!1},{label:"\u516c\u5f00",value:!0}]},N="\u5fc5\u586b\u9879",y=function(e){return"\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7".concat(e)},w=n(337),z=n(388),C=n(343),I=n(576),x=n(589),k=n(577),P=n(578),S=n(256),T=n(94),V=n(13),D=n(120),A=n(166),L=n(587),W=n(568),M=n(590),R=n(113),U=n(257),F=n(173),B=n(296),_=n.n(B),q=n(253),J=n(233),Y=n(126),G=n(387),H=n(11),K=n(383),Q=n(386),X=Object(q.a)(function(e){return Object(J.a)({root:{flexGrow:1,marginBottom:e.spacing(1)},input:{display:"flex",padding:0,height:"auto"},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:e.spacing(.5,.25)},chipFocused:{backgroundColor:Object(F.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,bottom:6,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0},divider:{height:e.spacing(2)}})});function Z(e){var t=e.inputRef,n=Object(D.a)(e,["inputRef"]);return m.a.createElement("div",Object.assign({ref:t},n))}var $={Control:function(e){return m.a.createElement(L.a,Object.assign({style:{minWidth:e.selectProps.minWidth||350},InputProps:{inputComponent:Z,inputProps:Object(g.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.TextFieldProps))},Menu:function(e){return m.a.createElement(R.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return m.a.createElement(M.a,{tabIndex:-1,label:e.children,className:Object(H.a)(e.selectProps.classes.chip,Object(V.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:m.a.createElement(_.a,e.removeProps)})},NoOptionsMessage:function(e){return m.a.createElement(A.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return m.a.createElement(W.a,Object.assign({ref:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return m.a.createElement(A.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},SingleValue:function(e){return m.a.createElement(A.a,Object.assign({className:e.selectProps.classes.singleValue},e.innerProps),e.children)},ValueContainer:function(e){return m.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}};var ee=function(e){var t=X(),n=Object(Y.a)(),a=e.loadOptions,r=e.isMulti,i=e.onChange,c=e.options,o=e.selected,l=e.value,s={input:function(e){return Object(g.a)({},e,{color:n.palette.text.primary,"& input":{font:"inherit"}})}},u={minWidth:e.minWidth,cacheOptions:!0,defaultValue:o||[],isMulti:r||!1,noOptionsMessage:function(e){var t=e.inputValue;return t&&t.trim()?"\u641c\u4e0d\u5230\u6570\u636e":"\u8bf7\u8f93\u5165\u68c0\u7d22\u5173\u952e\u5b57"},onChange:function(e){Array.isArray(e)?i(e.map(function(e){return{id:e.value,fullname:e.label}})):i([{id:e.value,fullname:e.label}])},placeholder:"\u8bf7\u9009\u62e9(".concat(r?"\u591a\u9009":"\u5355\u9009",")")};if(l&&(u.value=l),a)return m.a.createElement("div",{className:t.root},m.a.createElement(U.a,null,m.a.createElement(K.a,Object.assign({classes:t,loadOptions:Q(a,250),components:$},u))));if(c)return m.a.createElement("div",{className:t.root},m.a.createElement(U.a,null,m.a.createElement(G.a,Object.assign({classes:t,styles:s,TextFieldProps:{InputLabelProps:{shrink:!0}},options:c,components:$},u))));throw new Error("One of props.options and props.loadOptions is required.")},te=n(40),ne=n(54),ae=n(14),re=n(52),ie=Object(T.a)(function(e){var t=e.spacing;return{root:{},appBar:{position:"relative"},title:{marginLeft:t(2),flex:1},preview:{marginTop:t(1)},form:{minWidth:500,minHeight:300},formTitle:{color:"rgba(0, 0, 0, 0.54)",fontSize:9},formItem:{marginBottom:t(1)},ctl:{marginTop:t(3)}}}),ce=C.object().shape({name:C.string().required(N).max(20,y(20)),description:C.string().max(1e3,y(1e3))}),oe={id:0,name:"",description:"",members:[],visibility:!1},le=m.a.forwardRef(function(e,t){return m.a.createElement(I.a,Object.assign({direction:"up",ref:t},e))});var se=function(e){var t=e.open,n=e.onClose,a=e.organization,r=Object(O.e)(function(e){return e.auth}),i=ie(),c=Object(O.d)();return m.a.createElement(x.a,{open:t,onClose:function(){return n()},TransitionComponent:le},m.a.createElement(k.a,null,"\u65b0\u5efa\u56e2\u961f"),m.a.createElement(P.a,{dividers:!0},m.a.createElement("div",{className:i.form},m.a.createElement(w.c,{initialValues:Object(g.a)({},oe,a||{}),validationSchema:ce,onSubmit:function(e){var t=e.id?ae.v:ae.a,a=Object(g.a)({},e,{memberIds:(e.members||[]).map(function(e){return e.id})}),r=e.owner,i=e.newOwner;i&&i.id!==r.id&&(a.ownerId=i.id),c(t(a,function(){c(Object(re.c)()),n(!0)}))},render:function(e){var t=e.isSubmitting,a=e.setFieldValue,c=e.values;function o(e){return new Promise(function(){var t=Object(v.a)(b.a.mark(function t(n){var a,r;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,te.a.fetchUserList({name:e});case 2:a=t.sent,r=ne.differenceWith(a.data,c.members||[],ne.isEqual),n(r.map(function(e){return{label:"".concat(e.fullname," ").concat(e.empId||e.email),value:e.id}}));case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}return m.a.createElement(w.b,null,m.a.createElement("div",{className:"rmodal-body"},c.id>0&&m.a.createElement("div",{className:i.formItem},m.a.createElement("div",{className:i.formTitle},"\u9879\u76eeOwner"),c.owner&&c.owner.id===r.id?m.a.createElement(ee,{isMulti:!1,value:c.newOwner?[{label:c.newOwner.fullname,value:c.newOwner.id}]:[],loadOptions:o,onChange:function(e){return a("newOwner",e[0])}}):m.a.createElement("div",{className:"pt7 pl9"},c.owner.fullname)),m.a.createElement("div",{className:i.formItem},m.a.createElement(E.a,{data:j.RADIO_LIST_DATA_VISIBILITY,curVal:c.visibility,name:"visibility",onChange:function(e){return a("visibility",e)}})),m.a.createElement("div",{className:i.formItem},m.a.createElement(w.a,{name:"name",label:"\u56e2\u961f\u540d\u79f0",component:z.a,fullWidth:!0})),m.a.createElement("div",{className:i.formItem},m.a.createElement(w.a,{name:"description",label:"\u63cf\u8ff0",component:z.a,fullWidth:!0})),m.a.createElement("div",{className:i.formItem},m.a.createElement("div",{className:i.formTitle},"\u9879\u76ee\u6210\u5458"),m.a.createElement(ee,{isMulti:!0,loadOptions:o,selected:c.members.map(function(e){return{label:e.fullname,value:e.id}}),onChange:function(e){return a("members",e)}}))),m.a.createElement("div",{className:i.ctl},m.a.createElement(S.a,{type:"submit",variant:"contained",color:"primary",className:"mr1",disabled:t},"\u63d0\u4ea4"),m.a.createElement(S.a,{onClick:function(){return n()},disabled:t},"\u53d6\u6d88")))}}))))},ue=n(65);function me(e){return"https://work.alibaba-inc.com/photo/".concat(e.empId,".220x220.jpg")}var de=function(e){var t=e.organization,n=Object(O.e)(function(e){return e.auth}),a=Object(u.useState)(!1),r=Object(s.a)(a,2),i=r[0],c=r[1],o=t.owner&&t.owner.id===n.id,l=t.members.find(function(e){return e.id===n.id});return m.a.createElement("section",{className:"Organization card"},m.a.createElement("div",{className:"card-block"},m.a.createElement("div",{className:"header clearfix"},m.a.createElement("span",{className:"title"},m.a.createElement(ue.k,{className:"mr6 color-9"}),m.a.createElement(f.a,{to:"/organization/repository?organization=".concat(t.id)},t.name)),m.a.createElement("span",{className:"toolbar"},o||l?m.a.createElement("span",{className:"fake-link operation mr5",onClick:function(){return c(!0)}},"\u7f16\u8f91"):null,m.a.createElement(se,{organization:t,open:i,onClose:function(){return c(!1)}}),o?m.a.createElement(f.a,{to:"",onClick:function(e){return Ne(e,t)},className:"operation mr5"},"\u5220\u9664"):null,!o&&l?m.a.createElement(f.a,{to:"",onClick:function(e){return we(e,t)},className:"operation mr5"},"\u9000\u51fa"):null,null)),m.a.createElement("div",{className:"body"},m.a.createElement("div",{className:"desc"},t.description),m.a.createElement("div",{className:"members"},m.a.createElement(p.e,{content:"".concat(t.owner.fullname," ").concat(t.owner.id)},m.a.createElement("img",{alt:t.owner.fullname,src:me(t.owner),className:"avatar owner"})),t.members.map(function(e){return m.a.createElement(p.e,{key:e.id,content:"".concat(e.fullname," ").concat(e.id)},m.a.createElement("img",{alt:e.fullname,title:e.fullname,src:me(e),className:"avatar"}))})))))},pe=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.organizations;return n.length?m.a.createElement("div",{className:"OrganizationList"},n.map(function(e){return m.a.createElement(de,{key:e.id,organization:e})})):t?m.a.createElement("div",{className:"fontsize-14 text-center p40"},"\u6ca1\u6709\u627e\u5230\u5339\u914d ",m.a.createElement("strong",null,t)," \u7684\u56e2\u961f\u3002"):m.a.createElement("div",{className:"fontsize-14 text-center p40"},"\u6ca1\u6709\u6570\u636e\u3002")}}]),t}(u.Component),fe=n(584);n.d(t,"g",function(){return he}),n.d(t,"f",function(){return be}),n.d(t,"h",function(){return ve}),n.d(t,"l",function(){return ge}),n.d(t,"a",function(){return Oe}),n.d(t,"c",function(){return Ee}),n.d(t,"e",function(){return je}),n.d(t,"i",function(){return Ne}),n.d(t,"k",function(){return ye}),n.d(t,"j",function(){return we}),n.d(t,"b",function(){return ze}),n.d(t,"d",function(){return Ce});var he={store:d.d.object},be={history:d.d.object,location:d.d.object,match:d.d.object,onAddOrganization:d.d.func,onDeleteOrganization:d.d.func,onUpdateOrganization:d.d.func,auth:d.d.object};function ve(){var e=this.props;return{history:e.history,location:e.location,match:e.match,onAddOrganization:e.onAddOrganization,onDeleteOrganization:e.onDeleteOrganization,onUpdateOrganization:e.onUpdateOrganization,auth:e.auth}}var ge={onAddOrganization:ae.a,onDeleteOrganization:ae.d,onUpdateOrganization:ae.v};function Oe(){var e=Object(u.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1];return m.a.createElement("span",{className:"float-right ml10"},m.a.createElement(S.a,{className:"OrganizationCreateButton",variant:"contained",color:"primary",onClick:function(){return a(!0)}}," \u65b0\u5efa\u56e2\u961f "),m.a.createElement(se,{open:n,onClose:function(){return a(!1)}}))}function Ee(e){var t=e.url,n=Object(O.d)();return m.a.createElement(fe.a,{className:"mr8",value:t,onChange:function(e){return t=e.target.value,void n(Object(d.m)(t));var t}},m.a.createElement(W.a,{value:"/organization/joined"},"\u6211\u7684\u56e2\u961f"),m.a.createElement(W.a,{value:"/organization/all"},"\u5168\u90e8\u56e2\u961f"))}function je(e){var t=e.name,n=Object(O.d)(),a=Object(O.e)(function(e){return e.router}),r=Object(u.useState)(""),i=Object(s.a)(r,2),c=i[0],o=i[1];return Object(u.useEffect)(function(){o(t)},[t]),m.a.createElement(L.a,{value:c||"",placeholder:"\u641c\u7d22\u4ed3\u5e93\uff1a\u540d\u79f0\u3001ID",autoComplete:"off",onChange:function(e){return o(e.target.value.trim())},onKeyUp:function(e){return 13===e.which&&function(){var e=a.location,t=e.pathname,r=e.hash,i=e.search,o=Object(d.h)(t+r+i).removeSearch("cursor");c?o.setSearch("name",c):o.removeSearch("name"),n(Object(d.m)(o.href()))}()},style:{width:200}})}function Ne(e,t){var n=this;e.preventDefault();var a="\u56e2\u961f\u88ab\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff01\n\u786e\u8ba4\u7ee7\u7eed\u5220\u9664\u300e#".concat(t.id," ").concat(t.name,"\u300f\u5417\uff1f");window.confirm(a)&&(0,this.context.onDeleteOrganization)(t.id,function(){n.replaceLocation()})}function ye(e,t){var n=this;e.preventDefault();var a=this.context,r=a.auth;(0,a.onUpdateOrganization)({id:t.id,memberIds:[].concat(Object(l.a)(t.members.map(function(e){return e.id})),[r.id])},function(){n.replaceLocation()})}function we(e,t){var n=this;e.preventDefault();var a="\u786e\u8ba4\u7ee7\u7eed\u9000\u51fa\u300e#".concat(t.id," ").concat(t.name,"\u300f\u5417\uff1f");if(window.confirm(a)){var r=this.context,i=r.auth;(0,r.onUpdateOrganization)({id:t.id,memberIds:t.members.filter(function(e){return e.id!==i.id}).map(function(e){return e.id})},function(){n.replaceLocation()})}}var ze=function(e){var t=e.name,n=e.organizations;return n.fetching?m.a.createElement(p.l,null):m.a.createElement(pe,{name:t,organizations:n.data})},Ce=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.calculated,t=this.context.location;return m.a.createElement(p.d,{location:t,calculated:e})}}]),t}(u.Component);Ce.contextTypes={location:d.d.object}},579:function(e,t,n){"use strict";n.r(t);var a=n(18),r=n(19),i=n(22),c=n(20),o=n(21),l=n(0),s=n.n(l),u=n(26),m=n(338),d=(n(336),function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(n=Object(i.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(o)))).getChildContext=m.h,n}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.location,n=e.match,a=e.organizations;return s.a.createElement("section",{className:"OrganizationListWrapper"},s.a.createElement("nav",{className:"toolbar clearfix"},s.a.createElement(m.c,{url:n.url}),s.a.createElement(m.e,{name:t.params.name}),s.a.createElement(m.a,null)),s.a.createElement("div",{className:"body"},s.a.createElement(m.b,{name:t.params.name,organizations:a})),s.a.createElement("div",{className:"footer"},s.a.createElement(m.d,{calculated:a.pagination})))}}]),t}(l.Component));d.contextTypes=m.g,d.childContextTypes=m.f;t.default=Object(u.c)(function(e){return{auth:e.auth,organizations:e.organizations}},m.l)(d)}}]);
//# sourceMappingURL=11.774fcf34.chunk.js.map